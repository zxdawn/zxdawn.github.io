<!doctype html><html lang=zn-Hans><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge, chrome=1"><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no,maximum-scale=1"><meta name=author content="Xin Zhang"><meta name=description content="Aplication of PERMM for WRF-Chem"><meta property="og:title" content="Integrated Reaction Rates (Part2)"><meta property="og:description" content="Aplication of PERMM for WRF-Chem"><meta property="og:type" content="article"><meta property="og:url" content="https://zxdawn.github.io/2020/12/01/integrated-reaction-rates-part2/"><meta property="article:section" content="sci-tech"><meta property="article:published_time" content="2020-12-01T00:00:00+00:00"><meta property="article:modified_time" content="2020-12-01T00:00:00+00:00"><title>Integrated Reaction Rates (Part2) | Dreambooker</title><link rel=canonical href=https://zxdawn.github.io/2020/12/01/integrated-reaction-rates-part2/><link href=https://zxdawn.github.io/vendors/fontawesome-free-5.14.0-web/css/all.min.css rel=stylesheet><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:400,700|Ubuntu+Mono:400,400i,700,700i|Raleway:300,400,500,600"><link href=https://zxdawn.github.io/css/font.css rel=stylesheet><link href=https://zxdawn.github.io/css/vendors/bootstrap4/bootstrap.min.css rel=stylesheet><link href=https://zxdawn.github.io/css/vendors-extensions/mdb/mdb.min.css rel=stylesheet><link href=https://zxdawn.github.io/css/vendors/mdb/style.min.css rel=stylesheet><link href=https://zxdawn.github.io/css/main.css rel=stylesheet><link rel="shortcut icon" href=https://zxdawn.github.io/img/logo.jpg><style type=text/css>@media(min-width:800px) and (max-width:850px){.navbar:not(.top-nav-collapse){background:#1c2331!important}}</style><link rel=stylesheet href=https://zxdawn.github.io/css/vendors/highlight/github-gist.css></head><body class=bg-light data-spy=scroll data-target=#page-scrollspy data-offset=90><nav class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class=container><a class=navbar-brand href=https://zxdawn.github.io><img class=avatar src=https://zxdawn.github.io/img/logo.jpg style=width:40px!important;height:auto class="d-inline-block align-top" alt>
<strong>Xin Zhang</strong></a>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarSupportedContent><ul class="navbar-nav mr-auto"><li class=nav-item><a class=nav-link href=https://zxdawn.github.io>Home</a></li><li class=nav-item><a class=nav-link href=https://zxdawn.github.io/sci-tech/>Sci-Tech</a></li><li class=nav-item><a class=nav-link href=https://zxdawn.github.io/essay/>Essay</a></li><li class=nav-item><a class=nav-link href=https://zxdawn.github.io/album/>Album</a></li><li class=nav-item><a class=nav-link href=https://zxdawn.github.io/about/>About</a></li></ul></div></div></nav><div id=site-header class="carousel slide carousel-fade" data-ride=carousel style=height:18rem><div class=carousel-inner role=listbox><div class="carousel-item active"><div class=view style=background-image:url(https://zxdawn.github.io/img/header-slides/0.jpg);background-repeat:no-repeat;background-size:cover><div class="mask rgba-black-light d-flex justify-content-center align-items-center"></div></div></div><div class=carousel-item><div class=view style=background-image:url(https://zxdawn.github.io/img/header-slides//1.jpg);background-repeat:no-repeat;background-size:cover><div class="mask rgba-black-light d-flex justify-content-center align-items-center"></div></div></div><div class=carousel-item><div class=view style=background-image:url(https://zxdawn.github.io/img/header-slides//2.jpg);background-repeat:no-repeat;background-size:cover><div class="mask rgba-black-light d-flex justify-content-center align-items-center"></div></div></div><div class=carousel-item><div class=view style=background-image:url(https://zxdawn.github.io/img/header-slides//3.jpg);background-repeat:no-repeat;background-size:cover><div class="mask rgba-black-light d-flex justify-content-center align-items-center"></div></div></div><div class=carousel-item><div class=view style=background-image:url(https://zxdawn.github.io/img/header-slides//4.jpg);background-repeat:no-repeat;background-size:cover><div class="mask rgba-black-light d-flex justify-content-center align-items-center"></div></div></div></div><div class="carousel-content text-center white-text wow fadeIn"><div class="row mx-0 headfont mt-3 pt-4"><div class="col-12 col-sm-5 align-middle"><a href=https://zxdawn.github.io><img class="pull-right avatar avatar-md" src=https://zxdawn.github.io/img/me.jpg alt></a></div><div class="col-12 col-sm-7 text-left pl-2"><a href=https://zxdawn.github.io><h1 class="mb-2 h1" style=font-weight:300><strong>Dreambooker</strong></h1></a><div class=mt-2 style=font-size:1rem;color:#fff><a href=//github.com/zxdawn target=_blank rel="noopener me"><i class="fab fa-github pr-1" aria-hidden=true></i></a>
<a href=//twitter.com/zhangxin_dawn target=_blank rel="noopener me"><i class="fab fa-twitter pr-1" aria-hidden=true></i></a>
<a href=//instagram.com/zhangxin_dawn/ target=_blank rel="noopener me"><i class="fab fa-instagram pr-1" aria-hidden=true></i></a>
<a href=mailto:xinzhang1215@gmail.com><i class="far fa-envelope-open pr-1" aria-hidden=true></i></a></div></div></div></div></div><main class=post-main-wrapper><div class=row><div class=col-md-10><div class="z-depth-1 post-wrapper white-bg single-post dont-break-out"><div class="post-header text-center"><ul class="post-meta li-x"><li><a href=https://zxdawn.github.io/categories/sci-tech><i class="fas fa-folder-open pr-1" aria-hidden=true></i> sci-tech</a></li></ul><div class="px-4 post-heading">Integrated Reaction Rates (Part2)</div><ul class="post-meta li-x mt-1"><li>Dec 1, 2020</li><li class=middot></li><li>5 minute read</li></ul><div class=view><img src=https://zxdawn.github.io/images/sci-tech/2020-12/cover.png></div></div><div class="post-content markdown"><h2 id=background>Background</h2><p>Output of Integrated Reaction Rates (IRR) is available in WRF-Chem from V4.0 and IRR can be analyzed with PERMM Analysis Tool. You can check the instruction on the <a href=https://www2.acom.ucar.edu/wrf-chem>UCAR website</a>.</p><p>This post is the part2 which focuses on <em><em>the application of PERMM for the WRF-Chem IRR</em> data</em>*.</p><p>If you wanna learn the basic usage of PERMM, please check <a href=https://dreambooker.site/2020/11/30/Integrated-Reaction-Rates-Part1/>part1</a>.</p><p>If you wanna define your own mechanism file, please check <a href=https://dreambooker.site/2020/12/02/Integrated-Reaction-Rates-Part3/>part3</a>.</p><h2 id=reactions-related-to-o3>Reactions related to O3</h2><p>In the WRF-Chem, the reactions are written by the KPP and the IRR outputs are saved as <code>IRR_DIAG_d0*_***</code> if you enable it.</p><p>We can print the reactions producing O3 using the PERMM without the IRR* files.</p><p>I will focus on the <strong>MOZART mechanism</strong>:</p><pre tabindex=0><code>$ python -m permm -i --mechanism mozart_wrfchem

#  all reaction names that create O3
&gt;&gt;&gt; find_rxns(products=O3)
[&#39;CH3CO3_HO2_IRR&#39;, &#39;ISOP_O3_IRR&#39;, &#39;MACR_O3_IRR&#39;, &#39;MCO3_HO2_IRR&#39;, &#39;MVK_O3_IRR&#39;, &#39;NO3_HV_IRR&#39;, &#39;O_M_IRR&#39;]

# all reaction names related to O3 (either as reactants or products)
&gt;&gt;&gt; find_rxns(reactants=O3, products=O3, logical_and=False)
[&#39;C10H16_O3_IRR&#39;, &#39;C2H4_O3_IRR&#39;, &#39;C3H6_O3_IRR&#39;, &#39;CH3CO3_HO2_IRR&#39;, &#39;HO2_O3_IRR&#39;, &#39;ISOP_O3_IRR&#39;, &#39;MACR_O3_IRR&#39;, &#39;MCO3_HO2_IRR&#39;, &#39;MVK_O3_IRR&#39;, &#39;NO3_HV_IRR&#39;, &#39;O3_HV_IRR&#39;, &#39;O3_HV_a_IRR&#39;, &#39;O3_NO2_IRR&#39;, &#39;O3_NO_IRR&#39;, &#39;OH_O3_IRR&#39;, &#39;O_M_IRR&#39;, &#39;O_O3_IRR&#39;]

# print all reactions that create O3
&gt;&gt;&gt; print_rxns(products=O3)
ISOP_O3_IRR 1.0*ISOP + 1.0*O3 -&gt;[k] 0.6*CH2O + 0.4*MACR + 0.3*CO + 0.27*OH + 0.2*MVK + 0.2*MCO3 + 0.2*CH3COOH + 0.1*O3 + 0.07*C3H6 + 0.06*HO2
MACR_O3_IRR 1.0*MACR + 1.0*O3 -&gt;[k] 0.8*CH3COCHO + 0.7*CH2O + 0.275*HO2 + 0.215*OH + 0.2*O3 + 0.2*CO
MVK_O3_IRR 1.0*MVK + 1.0*O3 -&gt;[k] 0.95*CH3COCHO + 0.8*CH2O + 0.2*O3 + 0.08*OH + 0.06*HO2 + 0.05*CO + 0.04*CH3CHO
CH3CO3_HO2_IRR 1.0*CH3CO3 + 1.0*HO2 -&gt;[k] 0.75*CH3COOOH + 0.25*O3 + 0.25*CH3COOH
MCO3_HO2_IRR 1.0*HO2 + 1.0*MCO3 -&gt;[k] 0.75*CH3COOOH + 0.25*O3 + 0.25*CH3COOH
NO3_HV_IRR 1.0*NO3 -&gt;[j] 0.89*O3 + 0.89*NO2
O_M_IRR 1.0*M + 1.0*O -&gt;[k] 1.0*O3

# print net reaction
&gt;&gt;&gt; print_net_rxn(products=O3)
3*O3 + 2*HO2 + 1*CH3CO3 + 1*ISOP + 1*M + 1*MACR + 1*MCO3 + 1*MVK + 1*NO3 + 1*O -&gt;[n] 2.89*O3 + 2.1*CH2O + 1.75*CH3COCHO + 1.5*CH3COOOH + 0.89*NO2 + 0.7*CH3COOH + 0.565*OH + 0.55*CO + 0.4*MACR + 0.395*HO2 + 0.2*MVK + 0.2*MCO3 + 0.07*C3H6 + 0.04*CH3CHO
</code></pre><h2 id=irrs>IRRs</h2><h3 id=combine-irr-files>Combine IRR files</h3><p>We need to calculate the <strong>regional mean IRRs</strong> based on each IRR file.</p><p>The script below simplifies the plot process laster and make it reproducing.</p><pre tabindex=0><code>import os
import pandas as pd
import xarray as xr
import numpy as np
from glob import glob
from wrf import getvar

irr_dir = &#39;/WORK/nuist_chenq_2/xin/data/history/NJ/chem/20190725/lfr_lnox_waccm25_aeroff/&#39;
irr_file = sorted(glob(irr_dir+&#39;irr/IRR_DIAG_d03_2019-07-25_0[3-6]*&#39;))
wrfout_file = irr_file[0].replace(&#39;irr&#39;, &#39;wrfout&#39;).replace(&#39;IRR_DIAG&#39;, &#39;wrfout&#39;)

reactions = [&#39;C10H16_O3_IRR&#39;, &#39;C2H4_O3_IRR&#39;, &#39;C3H6_O3_IRR&#39;, &#39;CH3CO3_HO2_IRR&#39;, &#39;HO2_O3_IRR&#39;, &#39;ISOP_O3_IRR&#39;, &#39;MACR_O3_IRR&#39;, &#39;MCO3_HO2_IRR&#39;, &#39;MVK_O3_IRR&#39;, &#39;NO3_HV_IRR&#39;, &#39;O3_HV_IRR&#39;, &#39;O3_HV_a_IRR&#39;, &#39;O3_NO2_IRR&#39;, &#39;O3_NO_IRR&#39;, &#39;OH_O3_IRR&#39;, &#39;O_M_IRR&#39;, &#39;O_O3_IRR&#39;]

# set the region and height range
crop_region = [118.98, 119.13, 31.9, 32]
bottom = 0 # km
top = 1 # km

# open irr and wrfout data
ds_irr = xr.open_mfdataset(irr_file, combine=&#39;nested&#39;, concat_dim=&#39;Time&#39;)
ds_wrfout = xr.open_dataset(wrfout_file)

def mean_irr(ds_wrfout, ds_irr, reactions):
    &#39;&#39;&#39;Get the mean IRR in the crop_region and from bottom to top&#39;&#39;&#39;
    # pick interested reactions
    ds_irr = ds_irr[reactions]

    # get basic info from the wrfout file
    lon = ds_wrfout.XLONG.isel(Time=0)
    lat = ds_wrfout.XLAT.isel(Time=0)
    z = getvar(ds_wrfout._file_obj.ds, &#39;z&#39;, units=&#39;km&#39;)
    
    # calculate the mean IRR in the region
    subset = (lon&gt;=crop_region[0]) &amp; (lon&lt;=crop_region[1]) &amp; (lat&gt;=crop_region[2]) &amp; (lat&lt;=crop_region[3]) \
             &amp; (z &gt;= bottom) &amp; (z &lt;= top)
    
    # we use the &#34;difference&#34; here as the IRRs are integrated values
    ds_irr = ds_irr.where(subset.drop_vars([&#39;Time&#39;, &#39;XTIME&#39;]), drop=True)\
                     .mean(dim=[&#39;south_north&#39;, &#39;west_east&#39;, &#39;bottom_top&#39;])\
                     .diff(&#39;Time&#39;)

    return ds_irr

def conv_da(ds_irr):
    &#39;&#39;&#39;Convert IRR Dataset to DataArray and add coords&#39;&#39;&#39;
    # get the datetime for the Time coordinate
    times = pd.to_datetime(pd.Series([os.path.basename(f) for f in irr_file]), format=&#39;IRR_DIAG_d03_%Y-%m-%d_%H:%M:%S&#39;)[1:]
    times = times.to_xarray().drop_vars(&#39;index&#39;).rename({&#39;index&#39;: &#39;Time&#39;})

    # set the time coords and rename
    da_irr = ds_irr.assign_coords({&#39;Time&#39;: times}).to_array(dim=&#39;RXN&#39;, name=&#39;IRR&#39;).transpose()

    # convert the unit to pptv/s
    delta = times.diff(dim=&#39;Time&#39;)[0] / np.timedelta64(1, &#39;s&#39;) # seconds
    da_irr = da_irr * 1e6 / delta.values
    da_irr.attrs[&#39;units&#39;] = &#39;pptv/s&#39;

    return da_irr

ds_irr = mean_irr(ds_wrfout, ds_irr, reactions)
da_irr = conv_da(ds_irr)

# save to netcdf
comp = dict(zlib=True, complevel=9)
da_irr.to_netcdf(&#39;test.wrfchem.nc&#39;, encoding = {&#39;IRR&#39;: comp}, compute=True, engine=&#39;netcdf4&#39;)
</code></pre><p>What you need to modify is <code>irr_dir</code> and <code>irr_file</code>.</p><p>Of course, if you wanna calculate the mean IRRs based on the <em>bottom_up</em> levels, then we don&rsquo;t need the wrfout files anymore.</p><p>Anyway, I get the <em>z (km)</em> from the wrfout file using wrf-python.</p><p>When the script is finished successfully, you will get the nc file called <code>test.wrfchem.nc</code>.</p><h3 id=data-structure>Data structure</h3><p>This is the overview of combined IRR netcdf file by<code>xarray</code>:</p><pre tabindex=0><code>&gt;&gt;&gt; import xarray as xr
&gt;&gt;&gt; ds = xr.open_dataset(&#39;test.wrfchem.nc&#39;)
&gt;&gt;&gt; ds
&lt;xarray.Dataset&gt;
Dimensions:  (RXN: 17, Time: 23)
Coordinates:
  * Time     (Time) datetime64[ns] 2019-07-25T03:10:00 ... 2019-07-25T06:50:00
  * RXN      (RXN) object &#39;C10H16_O3_IRR&#39; &#39;C2H4_O3_IRR&#39; ... &#39;O_M_IRR&#39; &#39;O_O3_IRR&#39;
Data variables:
    IRR      (Time, RXN) float32 ...
</code></pre><p>The <em>IRR</em> is the only data variable with the <em>Time</em> and <em>RXN</em> dimension.</p><p>As the coordinates have been added before, we can access them easily to plot the IRR.</p><h3 id=plot-irrs>Plot IRRs</h3><p>As we have written the plot function in the part1 tutorial, we can edit it for the WRF-Chem IRR files this time.</p><pre tabindex=0><code>python -W ignore -m permm --mechanism mozart_wrfchem test.wrfchem.nc --scripts plot_irr_wrfchem.py
</code></pre><p>Here&rsquo;s the content of the script called <code>plot_irr_wrfchem.py</code>:</p><pre tabindex=0><code>import xarray as xr
import proplot as plot
import numpy as np

# get the basic info of reactions
reaction_names = find_rxns(reactants=O3, products=O3, logical_and=False)
reaction_eqs = get_rxns(reactants=O3, products=O3, logical_and=False)
reaction_dict = dict(zip(reaction_names, [eq.display(digits = None) for eq in reaction_eqs]))
reactant_names = find_rxns(reactants=O3)

# read the reaction file
ds = xr.open_dataset(&#39;./test.wrfchem.nc&#39;)
da = ds.sel(RXN=reaction_names)[&#39;IRR&#39;]

# multiple the irr by net coefficient
coefficient = [eq[&#39;O3&#39;].base.item()  for eq in reaction_eqs]
da *= coefficient

# we only want to plot the large contributions
# so, sorting the integrated IRR by absolute vlalues and picking the 8 of them for plot
large_contrib = da.sum(dim=&#39;Time&#39;).sortby(abs(da).sum(dim=&#39;Time&#39;), ascending=False).RXN[:8].values
irr_subset = da.sel(RXN=large_contrib)

# sort again for plot by real values
irr_subset = irr_subset.sortby(irr_subset.sum(dim=&#39;Time&#39;))

# generate labels based on RXN_**
labels = []
for rxn in irr_subset.RXN.values:
    labels.append(reaction_dict[rxn])

# plot
fig, axs = plot.subplots()
cmap = plot.Colormap(&#39;viridis&#39;)

lines = []
for i in range(irr_subset.sizes[&#39;RXN&#39;]):
    # &#34;step&#34;: https://matplotlib.org/3.1.1/gallery/lines_bars_and_markers/step_demo.html#sphx-glr-gallery-lines-bars-and-markers-step-demo-py
    line = axs.step(irr_subset.Time,
                    irr_subset.isel(RXN=i),
                    where=&#39;pre&#39;,
                    label=labels[i],
                    color=cmap(i / (len(irr_subset.RXN)-1)),
                    )
    lines.append(line)

# plot the total IRR
twin_ax = axs.alty(ycolor=&#39;gray6&#39;)
total_irr = da.sum(dim=&#39;RXN&#39;).rename(&#39;Total IRR&#39;)
total_irr.attrs[&#39;units&#39;] = da.attrs[&#39;units&#39;]
total_line = twin_ax.step(total_irr, where=&#39;pre&#39;, label=&#39;Total IRR&#39;, color=&#39;gray6&#39;)
twin_ax.format(grid=False)

# set axis
axs.format(xlabel=&#39;Time (UTC)&#39;,
           ylabel=f&#39;IRR ({da.attrs[&#34;units&#34;]})&#39;,
           xlim=(irr_subset.Time.values[0], irr_subset.Time.values[-1]),
           xlocator=(&#39;minute&#39;, range(0, 60, 30)),
           xminorlocator=(&#39;minute&#39;, range(0, 60, 10)),
           xformatter=&#39;%H:%M&#39;,
           title=&#39;Mean IRRs between the surface and 1 km&#39;,
           grid=False,
           )


fig.legend(lines.append(total_line), loc=&#39;b&#39;, ncols=2)
fig.savefig(&#39;irr_o3_wrfchem.png&#39;)
</code></pre><p>Here&rsquo;s the result:</p><p><img src=https://zxdawn.github.io/images/sci-tech/2020-12/irr_o3_wrfchem.png alt=ozone_reactions></p><p>Note that the simulation is for one convection case, so the decrease of O3 at the noon is reasonable.</p><h2 id=version-control>Version control</h2><table><thead><tr><th>Version</th><th>Action</th><th>Time</th></tr></thead><tbody><tr><td>1.0</td><td>Init</td><td>2020-12-01</td></tr><tr><td>1.1</td><td>Update coefficients</td><td>2020-12-02</td></tr></tbody></table></div><div class=row><div class=col-md-8><div class=mb-5><div class="li-x div-x post-meta"><li class=pr-0><a href=https://zxdawn.github.io/tags/><i class="fas fa-tags"></i></a></li><div class=tags-sm><li><a href=https://zxdawn.github.io/tags/wrf-chem role=button>wrf-chem</a></li><li><a href=https://zxdawn.github.io/tags/python role=button>python</a></li></div></div></div></div></div><div class="row pt-3"><div class=col-md-6><a href=https://zxdawn.github.io/2020/11/30/integrated-reaction-rates-part1/ class=post-meta>Previous<div class="pt-2 pb-5 d-flex"><i class="fas fa-angle-left text-grey font-weight-bold mr-2 active-color"></i>
<span>Integrated Reaction Rates (Part1)</span></div></a></div><div class="col-md-6 text-right"><a href=https://zxdawn.github.io/2020/12/02/integrated-reaction-rates-part3/ class=post-meta>Next<div class="pt-2 pb-5 flex-reverse"><i class="fas fa-angle-right text-grey font-weight-bold ml-2 active-color"></i>
<span>Integrated Reaction Rates (Part3)</span></div></a></div></div><section id=comments><hr><div id=comment-form><h3 id=comment-form-header>Say something</h3><form method=post action=https://ta1tk27bs2.execute-api.us-east-2.amazonaws.com/prod/v2/entry/zxdawn/zxdawn.github.io/main/comments><input type=hidden name=options[redirect] value=https://zxdawn.github.io/2020/12/01/integrated-reaction-rates-part2/#comment-submitted>
<input type=hidden name=options[redirectError] value=https://zxdawn.github.io/2020/12/01/integrated-reaction-rates-part2/#comment-error>
<input type=hidden name=options[slug] value=irr_wrfchem_2>
<input type=hidden name=options[section] value=sci-tech>
<input type=hidden name=options[origin] value=https://zxdawn.github.io/2020/12/01/integrated-reaction-rates-part2/>
<input type=hidden name=options[parent] value=irr_wrfchem_2>
<input type=hidden name=fields[reply_to]>
<input type=address name=fields[botpot] placeholder="botpot (do not fill!)" style=display:none><fieldset><input name=fields[name] type=text placeholder="Your name"></fieldset><fieldset><input name=fields[email] type=email placeholder="Your email address"></fieldset><fieldset><textarea name=fields[body] placeholder="You can use Markdown syntax" rows=10></textarea></fieldset><fieldset><div class=notify-me><input type=checkbox id=comment-form-reply name=options[subscribe] value=email>
<label for=comment-form-reply>Send me an email when someone comments on this post.</label></div></fieldset><fieldset><input type=submit value=Submit id=submit-button class=right>
<input type=reset value=Reset class=right></fieldset></form></div><div id=comment-submitted class=dialog><h3>Thank you</h3><p>Your comment has been submitted and will be published once it has been approved.</p></div><div id=comment-error class=dialog><h3>OOPS!</h3><p>Your comment has not been submitted. Please <a href=https://zxdawn.github.io/2020/12/01/integrated-reaction-rates-part2/>go back</a> and try again. Thank You!</p><p>If this error persists, please open an issue by <a href=https://github.com/zxdawn/zxdawn.github.io/issues>clicking here</a>.</p></div></section></div></div><div class="col-md-2 pl-0"><div id=page-scrollspy class=toc-nav><ul class="nav nav-pills ml-0"><li class="nav-item pb-3 text-center"><span class="font-weight-bold mb-2">- CATALOG -</span></li><ul class=nav><li class=nav-item><a class=nav-link href=#background>Background</a></li></ul><ul class=nav><li class=nav-item><a class=nav-link href=#reactions-related-to-o3>Reactions related to O3</a></li></ul><ul class=nav><li class=nav-item><a class=nav-link href=#irrs>IRRs</a></li></ul><ul class=nav><ul class=nav><li class=nav-item><a class=nav-link href=#combine-irr-files>Combine IRR files</a></li></ul></ul><ul class=nav><ul class=nav><li class=nav-item><a class=nav-link href=#data-structure>Data structure</a></li></ul></ul><ul class=nav><ul class=nav><li class=nav-item><a class=nav-link href=#plot-irrs>Plot IRRs</a></li></ul></ul><ul class=nav><li class=nav-item><a class=nav-link href=#version-control>Version control</a></li></ul></ul></div></div></div></main><script src=https://unpkg.com/vanilla-back-to-top@7.2.1/dist/vanilla-back-to-top.min.js></script>
<script>addBackToTop({diameter:56,backgroundColor:"rgb(255, 82, 82)",textColor:"#fff"})</script><footer class="page-footer text-center font-small mt-4 wow fadeIn"><script type=text/javascript src=https://documentservices.adobe.com/view-sdk/viewer.js></script><div class="pb-2 mt-5 pt-5"><a href=//github.com/zxdawn target=_blank rel="noopener me"><i class="fab fa-github pr-1" aria-hidden=true></i></a>
<a href=//twitter.com/zhangxin_dawn target=_blank rel="noopener me"><i class="fab fa-twitter pr-1" aria-hidden=true></i></a>
<a href=//instagram.com/zhangxin_dawn/ target=_blank rel="noopener me"><i class="fab fa-instagram pr-1" aria-hidden=true></i></a>
<a href=mailto:xinzhang1215@gmail.com><i class="far fa-envelope-open pr-1" aria-hidden=true></i></a></div><div class="copyright py-4"><span>2016 - 2025 &copy; | Theme <a href=https://github.com/EliiseS/AllinOne target=_blank>AllinOne</a></span></div></footer><script type=text/javascript src=https://zxdawn.github.io/js/vendors/jquery/jquery-3.3.1.min.js></script>
<script type=text/javascript src=https://zxdawn.github.io/js/vendors/jquery/jquery.smooth-scroll.min.js></script>
<script type=text/javascript src=https://zxdawn.github.io/js/vendors/popper.min.js></script>
<script type=text/javascript src=https://zxdawn.github.io/js/vendors/holder.min.js></script>
<script type=text/javascript src=https://zxdawn.github.io/js/vendors-extensions/bootstrap4/bootstrap.min.js></script>
<script type=text/javascript src=https://zxdawn.github.io/js/vendors/mdb/mdb.min.js></script>
<script type=text/javascript src=https://zxdawn.github.io/js/main.js></script>
<script src=https://zxdawn.github.io/js/vendors/highlight.pack.js></script><script>hljs.initHighlightingOnLoad()</script><script type=text/javascript>(new WOW).init()</script><script src=https://unpkg.com/vanilla-back-to-top@7.2.1/dist/vanilla-back-to-top.min.js></script>
<script>addBackToTop({diameter:56,backgroundColor:"rgb(255, 82, 82)",textColor:"#fff"})</script></body></html>