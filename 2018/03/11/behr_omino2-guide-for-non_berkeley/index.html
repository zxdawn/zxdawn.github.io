<!doctype html><html lang=zn-hans><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge, chrome=1"><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no,maximum-scale=1"><meta name=author content="Xin Zhang"><meta name=description content="BEHR_OMINO2 Guide for non_Berkeley
Clone BEHR_Core and other repositories
mkdir BEHR
cd BEHR
git clone https://github.com/CohenBerkeleyLab/BEHR-core.git
cd BEHR-core
./setup.sh # if you want to use develop branch, add --develop
"><meta property="og:title" content="BEHR_OMINO2 Guide for non_Berkeley"><meta property="og:description" content="BEHR_OMINO2 Guide for non_Berkeley
Clone BEHR_Core and other repositories
mkdir BEHR
cd BEHR
git clone https://github.com/CohenBerkeleyLab/BEHR-core.git
cd BEHR-core
./setup.sh # if you want to use develop branch, add --develop
"><meta property="og:type" content="article"><meta property="og:url" content="https://zxdawn.github.io/2018/03/11/behr_omino2-guide-for-non_berkeley/"><meta property="article:section" content="sci-tech"><meta property="article:published_time" content="2018-03-11T00:00:00+00:00"><meta property="article:modified_time" content="2018-03-11T00:00:00+00:00"><title>BEHR_OMINO2 Guide for non_Berkeley | Dreambooker</title><link rel=canonical href=https://zxdawn.github.io/2018/03/11/behr_omino2-guide-for-non_berkeley/><link href=https://zxdawn.github.io/vendors/fontawesome-free-5.14.0-web/css/all.min.css rel=stylesheet><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:400,700|Ubuntu+Mono:400,400i,700,700i|Raleway:300,400,500,600"><link href=https://zxdawn.github.io/css/font.css rel=stylesheet><link href=https://zxdawn.github.io/css/vendors/bootstrap4/bootstrap.min.css rel=stylesheet><link href=https://zxdawn.github.io/css/vendors-extensions/mdb/mdb.min.css rel=stylesheet><link href=https://zxdawn.github.io/css/vendors/mdb/style.min.css rel=stylesheet><link href=https://zxdawn.github.io/css/main.css rel=stylesheet><link rel="shortcut icon" href=https://zxdawn.github.io/img/logo.jpg><style type=text/css>@media(min-width:800px) and (max-width:850px){.navbar:not(.top-nav-collapse){background:#1c2331!important}}</style><link rel=stylesheet href=https://zxdawn.github.io/css/vendors/highlight/github-gist.css></head><body class=bg-light data-spy=scroll data-target=#page-scrollspy data-offset=90><nav class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class=container><a class=navbar-brand href=https://zxdawn.github.io><img class=avatar src=https://zxdawn.github.io/img/logo.jpg style=width:40px!important;height:auto class="d-inline-block align-top" alt>
<strong>Xin Zhang</strong></a>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarSupportedContent><ul class="navbar-nav mr-auto"><li class=nav-item><a class=nav-link href=https://zxdawn.github.io>Home</a></li><li class=nav-item><a class=nav-link href=https://zxdawn.github.io/sci-tech/>Sci-Tech</a></li><li class=nav-item><a class=nav-link href=https://zxdawn.github.io/essay/>Essay</a></li><li class=nav-item><a class=nav-link href=https://zxdawn.github.io/about/>About</a></li></ul></div></div></nav><div id=site-header class="carousel slide carousel-fade" data-ride=carousel style=height:18rem><div class=carousel-inner role=listbox><div class="carousel-item active"><div class=view style=background-image:url(https://zxdawn.github.io/img/header-slides/0.jpg);background-repeat:no-repeat;background-size:cover><div class="mask rgba-black-light d-flex justify-content-center align-items-center"></div></div></div><div class=carousel-item><div class=view style=background-image:url(https://zxdawn.github.io/img/header-slides//1.jpg);background-repeat:no-repeat;background-size:cover><div class="mask rgba-black-light d-flex justify-content-center align-items-center"></div></div></div><div class=carousel-item><div class=view style=background-image:url(https://zxdawn.github.io/img/header-slides//2.jpg);background-repeat:no-repeat;background-size:cover><div class="mask rgba-black-light d-flex justify-content-center align-items-center"></div></div></div><div class=carousel-item><div class=view style=background-image:url(https://zxdawn.github.io/img/header-slides//3.jpg);background-repeat:no-repeat;background-size:cover><div class="mask rgba-black-light d-flex justify-content-center align-items-center"></div></div></div><div class=carousel-item><div class=view style=background-image:url(https://zxdawn.github.io/img/header-slides//4.jpg);background-repeat:no-repeat;background-size:cover><div class="mask rgba-black-light d-flex justify-content-center align-items-center"></div></div></div></div><div class="carousel-content text-center white-text wow fadeIn"><div class="row mx-0 headfont mt-3 pt-4"><div class="col-12 col-sm-5 align-middle"><a href=https://zxdawn.github.io><img class="pull-right avatar avatar-md" src=https://zxdawn.github.io/img/me.jpg alt></a></div><div class="col-12 col-sm-7 text-left pl-2"><a href=https://zxdawn.github.io><h1 class="mb-2 h1" style=font-weight:300><strong>Dreambooker</strong></h1></a><div class=mt-2 style=font-size:1rem;color:#fff><a href=//github.com/zxdawn target=_blank rel="noopener me"><i class="fab fa-github pr-1" aria-hidden=true></i></a>
<a href=//twitter.com/zhangxin_dawn target=_blank rel="noopener me"><i class="fab fa-twitter pr-1" aria-hidden=true></i></a>
<a href=//instagram.com/zhangxin_dawn/ target=_blank rel="noopener me"><i class="fab fa-instagram pr-1" aria-hidden=true></i></a>
<a href=mailto:xinzhang1215@gmail.com><i class="far fa-envelope-open pr-1" aria-hidden=true></i></a></div></div></div></div></div><main class=post-main-wrapper><div class=row><div class=col-md-10><div class="z-depth-1 post-wrapper white-bg single-post dont-break-out"><div class="post-header text-center"><ul class="post-meta li-x"><li><a href=https://zxdawn.github.io/categories/sci-tech><i class="fas fa-folder-open pr-1" aria-hidden=true></i> sci-tech</a></li></ul><div class="px-4 post-heading">BEHR_OMINO2 Guide for non_Berkeley</div><ul class="post-meta li-x mt-1"><li>Mar 11, 2018</li><li class=middot></li><li>2 minute read</li></ul><div class=view><img src=https://zxdawn.github.io/images/sci-tech/2018-03/BEHR.jpg></div></div><div class="post-content markdown"><h1 id=behr_omino2-guide-for-non_berkeley>BEHR_OMINO2 Guide for non_Berkeley</h1><h2 id=clone-behr_corehttpsgithubcomcohenberkeleylabbehr-coregit-and-other-repositories>Clone <a href=https://github.com/CohenBerkeleyLab/BEHR-core.git>BEHR_Core</a> and other repositories</h2><pre tabindex=0><code>mkdir BEHR
cd BEHR
git clone https://github.com/CohenBerkeleyLab/BEHR-core.git
cd BEHR-core
./setup.sh # if you want to use develop branch, add --develop
</code></pre><h3 id=structure-of-repositories>Structure of repositories:</h3><pre tabindex=0><code>├── BEHR
│   ├── BEHR-core
│   ├── BEHR-core-utils
│   ├── BEHR-PSM-Gridding
│   ├── Matlab-Gen-Utils
│   ├── MatlabPythonInterface
│   └── WRF_Utils
</code></pre><p>If you don&rsquo;t have permission to change Matlab path, you should add BEHR to Matlab path every time:</p><p><code>addpath(genpath('your_BEHR_path'))</code></p><h2 id=create-behr_pathsm>Create behr_paths.m</h2><ol><li>Run <code>BEHR_initial_setup</code> in Matlab;</li><li>You will find <em>behr_paths.m</em> in BEHR-core-utils/Utils/Constants;</li><li>Change paths in behr_paths.m by yourself. Check that all the paths listed in behr_paths.m are
correct. You can validate them by running behr_paths.ValidatePaths() in Matlab, it should return 1 (0 means at least one path is invalid).</li></ol><h3 id=note>Note</h3><ol><li><strong>sp_mat_dir</strong> should have subdirectories for each region to be produced (e.g. &ldquo;us&rdquo; - must be lower case)</li><li><strong>behr_mat_dir</strong> should have subdirectories for each region to be produced and within each region directories &ldquo;daily&rdquo; and &ldquo;monthly&rdquo;.</li><li><strong>myd06_dir</strong> should contain folders for each year with MYD06_L2 files in them.</li><li><strong>mcd43d_dir</strong> should contain folders for each year with MCD43D* files in them.</li><li><strong>wrf_profiles</strong> it assumes that WRF files are organized in a directory structure behr_paths.wrf_profiles/// where is the region being retrieved (passed as the &ldquo;region&rdquo; input), is the four-digit year and is the two-digit month. If you specify wrf_output_path explicitly, then it assumes all WRF output files are in that directory.</li></ol><h2 id=download-data>Download data</h2><p>Check Section 4.3 of BEHR_Read_me file.</p><h3 id=download-url>Download url</h3><p><strong>GLOBE database</strong></p><p><a href=https://www.ngdc.noaa.gov/mgg/topo/gltiles.html>https://www.ngdc.noaa.gov/mgg/topo/gltiles.html</a> , <a href=https://www.ngdc.noaa.gov/mgg/topo/elev/esri/hdr/>https://www.ngdc.noaa.gov/mgg/topo/elev/esri/hdr/</a></p><p><strong>Land_Water_Mask_7Classes_UMD.hdf</strong></p><p><a href=ftp://rsftp.eeos.umb.edu/data02/Gapfilled/>ftp://rsftp.eeos.umb.edu/data02/Gapfilled/</a></p><p><strong>OMNO2 and OMPIXCOR</strong></p><p><a href=https://mirador.gsfc.nasa.gov/>https://mirador.gsfc.nasa.gov/</a></p><p><strong>MCD43D07, MCD43D08, MCD43D09 and MCD43D31</strong></p><p><a href=https://e4ftl01.cr.usgs.gov/MOTA/>https://e4ftl01.cr.usgs.gov/MOTA/</a></p><p><strong>MYD06_L2</strong></p><p><a href=https://search.earthdata.nasa.gov/>https://search.earthdata.nasa.gov/</a></p><p><strong>sortscript.sh</strong></p><p><a href=https://github.com/CohenBerkeleyLab/OtherSatelliteUtils/blob/master/OMI%20Utils/DOMINO/sortscript.sh>https://github.com/CohenBerkeleyLab/OtherSatelliteUtils/blob/master/OMI%20Utils/DOMINO/sortscript.sh</a></p><p>Modify sortscript.sh:</p><pre tabindex=0><code>For OMNO2:
    36     y=${fname:18:4}
    37     m=${fname:23:2}
For OMPIXCOR:
    36     y=${fname:21:4}
    37     m=${fname:26:2}
</code></pre><h3 id=structure-example-of-data-files>Structure example of data files:</h3><pre tabindex=0><code>├── GLOBE_Database
│   ├── a10g
│   ├── a10g.hdr
│   ├── ...........
│   ├── p10g
│   └── p10g.hdr
├── MODIS
│   ├── Land_Water_Mask_7Classes_UMD.hdf
│   ├── MCD43D
│   │   └── 2017
│   └── MYD06_L2
│       └── 2017
├── OMI
│   ├── OMNO2
│   │   └── version_3_3_0
│   │       ├── 2017
│   │       │   └── 04
│   │       └── download_staging
│   │           ├── download
│   │           └── sortscript.sh
│   └── OMPIXCOR
│       └── version_003
│           ├── 2017
│           │   └── 04
│           └── download_staging
│               ├── download
│               └── sortscript.sh
</code></pre><h2 id=read-data>Read data</h2><ol><li>Set date_start, date_end, region and DEBUG_LEVEL in <code>*/BEHR/BEHR-core/Read_Data/read_main.m</code>;</li><li>Run <code>read_main.m</code></li><li>Check SP_Files.</li></ol><h2 id=recalculate-amf-and-tropospheric-column>Recalculate AMF and Tropospheric Column</h2><ol><li>Initialize parameters of BEHR_main.m</li><li><a href=https://github.com/zxdawn/BEHR-PSM-Gridding>Set python environment</a> for BEHR-PSM-Gridding and <a href=https://github.com/zxdawn/BEHR-PSM-Gridding/blob/develop/omi/help.txt>compile</a> omi.</li><li>Run <code>BEHR_main.m</code></li></ol><h2 id=publish-omi_behr>Publish OMI_BEHR</h2><ol><li>Initialize parameters of <code>BEHR_publishing_main.m</code> (*/BEHR/BEHR-core/HDF tools)</li><li>Run <code>BEHR_publishing_main.m</code></li></ol><h2 id=reference>Reference</h2><p><a href=https://github.com/CohenBerkeleyLab/BEHR-core/tree/develop/Documentation>BEHR_Readme.pdf</a></p></div><div class=row><div class=col-md-8><div class=mb-5><div class="li-x div-x post-meta"><li class=pr-0><a href=https://zxdawn.github.io/tags/><i class="fas fa-tags"></i></a></li><div class=tags-sm><li><a href=https://zxdawn.github.io/tags/omi role=button>OMI</a></li><li><a href=https://zxdawn.github.io/tags/wrf-chem role=button>WRF-Chem</a></li></div></div></div></div></div><div class="row pt-3"><div class=col-md-6><a href=https://zxdawn.github.io/2018/01/18/remarkable-connecting-to-a-hotspot-which-supports-circumvention/ class=post-meta>Previous<div class="pt-2 pb-5 d-flex"><i class="fas fa-angle-left text-grey font-weight-bold mr-2 active-color"></i>
<span>Remarkable - Connecting to a hotspot which supports circumvention</span></div></a></div><div class="col-md-6 text-right"><a href=https://zxdawn.github.io/2018/04/20/initializing-the-wrf-model-with-era5/ class=post-meta>Next<div class="pt-2 pb-5 flex-reverse"><i class="fas fa-angle-right text-grey font-weight-bold ml-2 active-color"></i>
<span>Initializing the WRF model with ERA5</span></div></a></div></div><section id=comments><hr><div id=comment-form><h3 id=comment-form-header>Say something</h3><form method=post action=https://dreambooker-comment.onrender.com/v3/entry/github/zxdawn/zxdawn.github.io/main/comments><input type=hidden name=options[redirect] value=https://zxdawn.github.io/2018/03/11/behr_omino2-guide-for-non_berkeley/#comment-submitted>
<input type=hidden name=options[redirectError] value=https://zxdawn.github.io/2018/03/11/behr_omino2-guide-for-non_berkeley/#comment-error>
<input type=hidden name=options[slug] value=BEHR-OMINO2-Guide-for-non-Berkeley>
<input type=hidden name=options[section] value=sci-tech>
<input type=hidden name=options[origin] value=https://zxdawn.github.io/2018/03/11/behr_omino2-guide-for-non_berkeley/>
<input type=hidden name=options[parent] value=BEHR-OMINO2-Guide-for-non-Berkeley>
<input type=hidden name=fields[reply_to]>
<input type=address name=fields[botpot] placeholder="botpot (do not fill!)" style=display:none><fieldset><input name=fields[name] type=text placeholder="Your name"></fieldset><fieldset><input name=fields[email] type=email placeholder="Your email address"></fieldset><fieldset><textarea name=fields[body] placeholder="You can use Markdown syntax" rows=10></textarea></fieldset><fieldset><div class=notify-me><input type=checkbox id=comment-form-reply name=options[subscribe] value=email>
<label for=comment-form-reply>Send me an email when someone comments on this post.</label></div></fieldset><fieldset><input type=submit value=Submit id=submit-button class=right>
<input type=reset value=Reset class=right></fieldset></form></div><div id=comment-submitted class=dialog><h3>Thank you</h3><p>Your comment has been submitted and will be published once it has been approved.</p></div><div id=comment-error class=dialog><h3>OOPS!</h3><p>Your comment has not been submitted. Please <a href=https://zxdawn.github.io/2018/03/11/behr_omino2-guide-for-non_berkeley/>go back</a> and try again. Thank You!</p><p>If this error persists, please open an issue by <a href=https://github.com/zxdawn/zxdawn.github.io/issues>clicking here</a>.</p></div></section></div></div><div class="col-md-2 pl-0"><div id=page-scrollspy class=toc-nav><ul class="nav nav-pills ml-0"><li class="nav-item pb-3 text-center"><span class="font-weight-bold mb-2">- CATALOG -</span></li><ul class=nav><li class=nav-item><a class=nav-link href=#behr_omino2-guide-for-non_berkeley>BEHR_OMINO2 Guide for non_Berkeley</a></li></ul><ul class=nav><ul class=nav><li class=nav-item><a class=nav-link href=#clone-behr_corehttpsgithubcomcohenberkeleylabbehr-coregit-and-other-repositories>Clone BEHR_Core and other repositories</a></li></ul></ul><ul class=nav><ul class=nav><ul class=nav><li class=nav-item><a class=nav-link href=#structure-of-repositories>Structure of repositories:</a></li></ul></ul></ul><ul class=nav><ul class=nav><li class=nav-item><a class=nav-link href=#create-behr_pathsm>Create behr_paths.m</a></li></ul></ul><ul class=nav><ul class=nav><ul class=nav><li class=nav-item><a class=nav-link href=#note>Note</a></li></ul></ul></ul><ul class=nav><ul class=nav><li class=nav-item><a class=nav-link href=#download-data>Download data</a></li></ul></ul><ul class=nav><ul class=nav><ul class=nav><li class=nav-item><a class=nav-link href=#download-url>Download url</a></li></ul></ul></ul><ul class=nav><ul class=nav><ul class=nav><li class=nav-item><a class=nav-link href=#structure-example-of-data-files>Structure example of data files:</a></li></ul></ul></ul><ul class=nav><ul class=nav><li class=nav-item><a class=nav-link href=#read-data>Read data</a></li></ul></ul><ul class=nav><ul class=nav><li class=nav-item><a class=nav-link href=#recalculate-amf-and-tropospheric-column>Recalculate AMF and Tropospheric Column</a></li></ul></ul><ul class=nav><ul class=nav><li class=nav-item><a class=nav-link href=#publish-omi_behr>Publish OMI_BEHR</a></li></ul></ul><ul class=nav><ul class=nav><li class=nav-item><a class=nav-link href=#reference>Reference</a></li></ul></ul></ul></div></div></div></main><script src=https://unpkg.com/vanilla-back-to-top@7.2.1/dist/vanilla-back-to-top.min.js></script>
<script>addBackToTop({diameter:56,backgroundColor:"rgb(255, 82, 82)",textColor:"#fff"})</script><footer class="page-footer text-center font-small mt-4 wow fadeIn"><div class="pb-2 mt-5 pt-5"><a href=//github.com/zxdawn target=_blank rel="noopener me"><i class="fab fa-github pr-1" aria-hidden=true></i></a>
<a href=//twitter.com/zhangxin_dawn target=_blank rel="noopener me"><i class="fab fa-twitter pr-1" aria-hidden=true></i></a>
<a href=//instagram.com/zhangxin_dawn/ target=_blank rel="noopener me"><i class="fab fa-instagram pr-1" aria-hidden=true></i></a>
<a href=mailto:xinzhang1215@gmail.com><i class="far fa-envelope-open pr-1" aria-hidden=true></i></a></div><div class="copyright py-4"><span>2016 - 2022 &copy; | Theme <a href=https://github.com/EliiseS/AllinOne target=_blank>AllinOne</a></span></div></footer><script type=text/javascript src=https://zxdawn.github.io/js/vendors/jquery/jquery-3.3.1.min.js></script>
<script type=text/javascript src=https://zxdawn.github.io/js/vendors/jquery/jquery.smooth-scroll.min.js></script>
<script type=text/javascript src=https://zxdawn.github.io/js/vendors/popper.min.js></script>
<script type=text/javascript src=https://zxdawn.github.io/js/vendors/holder.min.js></script>
<script type=text/javascript src=https://zxdawn.github.io/js/vendors-extensions/bootstrap4/bootstrap.min.js></script>
<script type=text/javascript src=https://zxdawn.github.io/js/vendors/mdb/mdb.min.js></script>
<script type=text/javascript src=https://zxdawn.github.io/js/main.js></script>
<script src=https://zxdawn.github.io/js/vendors/highlight.pack.js></script><script>hljs.initHighlightingOnLoad()</script><script type=text/javascript>(new WOW).init()</script><script src=https://unpkg.com/vanilla-back-to-top@7.2.1/dist/vanilla-back-to-top.min.js></script>
<script>addBackToTop({diameter:56,backgroundColor:"rgb(255, 82, 82)",textColor:"#fff"})</script></body></html>